# 飞盘队训练助手 - 功能完善开发计划 (简化版)

**版本**: v1.1.0  
**制定日期**: 2025年7月17日  
**预计完成时间**: 2周  

---

## 📊 开发优先级排序 (已调整)

### Phase 1: 用户头像管理功能 (4天) - 最高优先级
### Phase 2: 盘名修改限制功能 (3天) - 中等优先级  
### Phase 3: 训练活动删除功能 (5天) - 较低优先级

---

## 🔧 简化技术方案

### 1. 用户头像管理功能

#### 数据库变更
```javascript
// Users 集合新增字段
{
  customAvatarUrl: String,    // 自定义头像URL
  avatarType: String,         // 'wechat' | 'custom'
}
```

#### 实现方案
- **图片上传**: `wx.chooseImage` + `wx.cloud.uploadFile`
- **图片压缩**: 前端压缩至200KB
- **存储路径**: `avatars/{openid}.jpg`
- **格式限制**: JPG/PNG，最大2MB

#### 开发任务 (4天)
- Day 1: 云存储配置 + 后端API
- Day 2: 图片压缩 + 上传功能
- Day 3: 前端界面集成
- Day 4: 测试优化

### 2. 盘名修改限制功能

#### 数据库变更
```javascript
// Users 集合新增字段
{
  discNameChangeCount: Number,    // 已修改次数，默认0
  discNameChangeHistory: Array,   // 修改历史 [{oldName, newName, changeTime}]
}
```

#### 业务规则
- 每用户最多修改3次
- 记录修改历史
- 超限后禁用功能

#### 开发任务 (3天)
- Day 1: 数据结构 + 后端逻辑
- Day 2: 前端界面 + 次数显示
- Day 3: 测试集成

### 3. 训练活动删除功能

#### 数据库变更
```javascript
// Events 集合新增字段
{
  isDeleted: Boolean,     // 软删除标记
  deleteTime: Date,       // 删除时间
  deletedBy: String,      // 删除操作者
}
```

#### 业务规则
- 仅管理员可删除
- 训练前2小时禁止删除
- 有报名需二次确认
- 软删除保留数据

#### 开发任务 (5天)
- Day 1: 数据库设计 + 权限验证
- Day 2: 删除逻辑 + 时间限制
- Day 3: 前端确认对话框
- Day 4: 用户通知功能
- Day 5: 测试优化

---

## 🧪 简化测试策略

### 核心测试用例

#### 头像管理测试
- [ ] 正常上传JPG/PNG图片
- [ ] 大文件自动压缩
- [ ] 网络异常重试
- [ ] 格式验证错误提示

#### 盘名限制测试
- [ ] 首次修改成功
- [ ] 第3次修改成功
- [ ] 第4次修改被拒绝
- [ ] 修改历史记录正确

#### 训练删除测试
- [ ] 管理员可删除
- [ ] 普通用户无权限
- [ ] 时间限制生效
- [ ] 有报名需确认

---

## 📈 成本评估

### 开发时间
- Phase 1: 4天
- Phase 2: 3天  
- Phase 3: 5天
- **总计**: 12天开发

### 云存储成本
- 100用户 × 200KB = 20MB
- **月成本**: < 0.5元

---

## 🚀 实施计划

### 第1周: Phase 1 + Phase 2 (7天)
- 周一-周四: 头像管理功能
- 周五-周日: 盘名限制功能

### 第2周: Phase 3 (5天)
- 周一-周五: 训练删除功能

### 测试发布
- 每个Phase完成后立即测试
- 收集反馈并快速修复
- 确保功能简洁高效

---

## ✅ 验收标准

### 功能验收
- [ ] 头像上传成功率 > 95%
- [ ] 盘名修改限制生效
- [ ] 训练删除权限正确
- [ ] 所有核心功能正常

### 性能验收
- [ ] 头像上传 < 5秒
- [ ] 页面响应 < 2秒
- [ ] 无明显卡顿

### 用户体验
- [ ] 操作流程简单直观
- [ ] 错误提示清晰明确
- [ ] 功能易于理解使用

---

**设计原则**: 保持简洁性，能简单高效地实现功能，不胡乱堆叠复杂特性

## 📊 开发进度状态

### ✅ Phase 1: 用户头像管理功能 (4天) - **已完成**
- [x] 云存储配置和后端API开发
- [x] 图片上传和压缩功能
- [x] 前端界面集成和优化
- [x] 测试验证和文档完善

### ✅ Phase 2: 盘名修改限制功能 (3天) - **已完成**
- [x] Day 1: 数据结构设计 + 后端逻辑开发
- [x] Day 2: 前端弹窗界面 + UI美化优化
- [x] Day 3: 测试集成 + 最终验收完成

### ⏳ Phase 3: 训练活动删除功能 (5天) - **待开发**
- [ ] 数据库设计 + 权限验证
- [ ] 删除逻辑 + 时间限制
- [ ] 前端确认对话框
- [ ] 用户通知功能
- [ ] 测试优化

---

**当前状态**: Phase 2 已完成，功能生产就绪，可继续Phase 3开发
