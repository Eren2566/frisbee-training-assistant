<!--pages/index/index.wxml-->
<view class="page page-enter">
  <!-- å¤´éƒ¨æ¬¢è¿åŒºåŸŸ -->
  <view class="header">
    <view class="welcome-text">
      <text class="title">FlyMate</text>
      <text class="subtitle">Your Ultimate Frisbee Companion</text>
      <view class="brand-tagline">
        <text class="tagline-text">âœ¨ Train Smart â€¢ Play Together â€¢ Fly High âœ¨</text>
      </view>
    </view>
  </view>

  <!-- æœªç™»å½•æç¤º -->
  <view class="card fade-in-up delay-100" wx:if="{{!isLoggedIn}}">
    <view class="login-prompt">
      <text class="prompt-text">è¯·å…ˆç™»å½•ä»¥ä½¿ç”¨å®Œæ•´åŠŸèƒ½</text>
      <button class="btn-primary btn-touch touch-optimized gpu-accelerated" bindtap="goToLogin">ç«‹å³ç™»å½•</button>
    </view>
  </view>

  <!-- è®­ç»ƒåŠ¨æ€ä¸­å¿ƒ -->
  <view class="training-center" wx:if="{{isLoggedIn}}">
    <!-- åŠ è½½çŠ¶æ€ -->
    <view class="loading-state" wx:if="{{isLoading}}">
      <view class="loading-spinner"></view>
      <text class="loading-text">åŠ è½½è®­ç»ƒä¿¡æ¯ä¸­...</text>
    </view>

    <!-- æœ‰ä¸‹æ¬¡è®­ç»ƒ -->
    <view class="training-card" wx:elif="{{nextEvent}}">
      <view class="training-header">
        <view class="training-icon">ğŸƒ</view>
        <text class="training-title">ä¸‹æ¬¡è®­ç»ƒ</text>
      </view>

      <view class="training-info">
        <view class="info-item">
          <view class="info-icon">ğŸ“…</view>
          <text class="info-text">{{nextEvent.title}}</text>
        </view>

        <view class="info-item">
          <view class="info-icon">â°</view>
          <text class="info-text">{{nextEvent.eventTime}}</text>
        </view>

        <view class="info-item">
          <view class="info-icon">ğŸ“</view>
          <text class="info-text">{{nextEvent.location}}</text>
        </view>

        <view class="info-item">
          <view class="info-icon">ğŸ‘¥</view>
          <text class="info-text">å·²æŠ¥å {{registrationCount}} äºº</text>
        </view>
      </view>

      <!-- å€’è®¡æ—¶ -->
      <view class="countdown-section" wx:if="{{countdownText}}">
        <view class="countdown-icon">â°</view>
        <text class="countdown-text">å€’è®¡æ—¶ï¼š{{countdownText}}</text>
      </view>

      <!-- æ“ä½œæŒ‰é’® -->
      <view class="action-buttons">
        <!-- æœªæŠ¥åç”¨æˆ·æ˜¾ç¤ºæŠ¥åæŒ‰é’® -->
        <button class="btn-primary action-btn" wx:if="{{!userEventStatus}}" bindtap="handleSignUp">
          ç«‹å³æŠ¥å
        </button>

        <!-- å·²æŠ¥åç”¨æˆ·æ˜¾ç¤ºè¯·å‡æŒ‰é’® -->
        <button class="btn-warning action-btn" wx:elif="{{userEventStatus.status === 'signed_up'}}" bindtap="handleLeave">
          ç”³è¯·è¯·å‡
        </button>

        <!-- å·²è¯·å‡ç”¨æˆ·æ˜¾ç¤ºçŠ¶æ€ -->
        <view class="status-text" wx:elif="{{userEventStatus.status === 'leave_requested'}}">
          <text class="leave-status">å·²è¯·å‡</text>
        </view>

        <!-- æŸ¥çœ‹è¯¦æƒ…æŒ‰é’® -->
        <button class="btn-secondary action-btn" bindtap="goToEventDetail">
          æŸ¥çœ‹è¯¦æƒ…
        </button>
      </view>
    </view>

    <!-- æ²¡æœ‰ä¸‹æ¬¡è®­ç»ƒ -->
    <view class="no-training-card" wx:else>
      <view class="no-training-icon">ğŸ“…</view>
      <text class="no-training-title">æš‚æ— å³å°†åˆ°æ¥çš„è®­ç»ƒ</text>
      <text class="no-training-desc">è¯·å…³æ³¨é˜Ÿé•¿å‘å¸ƒçš„æœ€æ–°è®­ç»ƒå®‰æ’</text>
      <button class="btn-secondary" bindtap="goToEventList">æŸ¥çœ‹æ‰€æœ‰è®­ç»ƒ</button>
    </view>
  </view>
</view>
